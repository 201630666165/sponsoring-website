
<!DOCTYPE html>
<html lang="en" style="height:100%;">
<head>
    <title>注册 </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Pragma" content="no-cache">
    <meta name="viewport" content="width=device-width,initial-scale=0.4,user-scalable=yes"/>
    <meta name="distribution" content="global">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Set render engine for 360 browser -->
    <meta name="renderer" content="webkit">
    <meta name="author" content="SSS">
    <meta name="publisher" content="SSS">

    <link href="register01.css" rel="stylesheet" type="text/css">
    <link rel="SHORTCUT ICON" href="images/sss.ico">
    <script src="gVerify.js"></script>
    <script src="jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="register.js"></script>
    

    <script type="text/javascript">
        $("html").css("background-image",function(){var ran = Math.ceil(Math.random()*10);return"url("+ran+".jpg)";});
        $("html").css("background-size","100% 100%");
        var uvOptions = {};
        var _atrk_opts = { atrk_acct: "GgKTe1aoiI00WL", domain: "yizanzhu.com", dynamic: true };

        function validateEmail(email) {
            if (email == null || $.trim(email) == "") return false;
            var pattern = /^([A-Za-z0-9]+)(([A-Za-z0-9]+)|(_+)|(\-+)|(\.+)|(\++))*@((\w+\-+)|(\w+\.))*\w{1,63}\.[a-zA-Z]{2,6}$/i;
            return pattern.test(email);
        }
        function validatePhone(phone) {
            if (phone == null || $.trim(phone) == "") return false;
            var pattern = /(^((0[1,2]{1}\d{1}-?\d{8})|(0[3-9]{1}\d{2}-?\d{7,8}))$)|(^(0|86|17951)?(13[0-9]|15[0-35-9]|17[0678]|18[0-9]|14[57])[0-9]{8}$)/;
            return pattern.test(phone);
        }
        Date.prototype.format = function (format) { //author: meizz
            var o = {
                "M+": this.getMonth() + 1, //month
                "d+": this.getDate(),    //day
                "h+": this.getHours(),   //hour
                "m+": this.getMinutes(), //minute
                "s+": this.getSeconds(), //second
                "q+": Math.floor((this.getMonth() + 3) / 3),  //quarter
                "S": this.getMilliseconds() //millisecond
            }
            if (/(y+)/.test(format)) format = format.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
            for (var k in o) if (new RegExp("(" + k + ")").test(format))
                format = format.replace(RegExp.$1, RegExp.$1.length == 1 ? o[k] : ("00" + o[k]).substr(("" + o[k]).length));
            return format;
        }
    </script>

</head>
<body>




<div class="container" style="margin-bottom:100px;">
    <a class="logo pull-left" href="index.html">
        <img src="logo1.png" alt="SSS" style="width:auto;"></a>
    <div class="sign-hd">
        <a class="links" href="index.html"><span class="icon-index"></span>回到首页</a>
    </div>

    <div class="sign-bd">
        <div class="title">
            <a class="links" href="login.html">已有帐号登录<span class="icon-goto"></span></a>
            注册SSS帐号
        </div>
        <div class="login-form">

            <div id="sign-mail">
                <form action="/register" autocomplete="off" class="form-horizontal" id="reg_form" method="post" style="width: 275px;" novalidate="novalidate">
                    <input name="returnUrl" value="" type="hidden">
                    <div class="form-group">
                        <span style="padding-right: 5px;">手机号码：</span>
                        <input class="form-control" style="padding-left:8px" placeholder="输入您常用手机" id="mobile" name="mobile" type="text">
                    </div>
                    <div class="form-group">
                        <span style="padding-right: 5px;">图片验证：</span>
                        <input class="form-control" style="padding-left:8px; width:78px;" placeholder="图片验证码" name="validate_code" id="validate_code" autocomplete="off" type="text">
                        <div title="点击刷新" style="width:95px; height:41px;" id="v_container"></div>
                    </div>
                    <!--<button class="btn btn-primary" type="button" onclick="getMobileValidateCode(); return false;" style="margin:0 0 10px 68px;">获取手机验证码</button>-->
                    <div class="form-group">
                        <span style="padding-right: 5px;">组织名称：</span>
                        <input class="form-control" style="padding-left:8px" placeholder="输入您所在企业/组织/个人名称" name="mobile_validate_code" id="mobile_validate_code" autocomplete="off" type="text">
                    </div>
                    <div class="form-group">
                        <span style="padding-right: 5px;">登录密码：</span>
                        <input class="form-control" style="padding-left:8px" placeholder="设置您的密码(不少于6位)" name="password" id="password" autocomplete="off" type="password">
                    </div>
                    <div class="form-group">
                        <span style="padding-right: 5px;">联系人姓名</span>
                        <input class="form-control" style="padding-left:8px" placeholder="请输入社团联系人真实姓名" name="username" id="username" autocomplete="off" type="text">
                    </div>
                    <div class="form-group">
                        <span style="padding-right: 5px;">电子邮箱：</span>
                        <input class="form-control" style="padding-left:8px" placeholder="请输入社团联系邮箱" name="e_mail" id="e_mail" autocomplete="off" type="text">
                    </div>
                    <div class="checkbox-inline">
                        <label>
                            <input checked="checked" type="checkbox" name="agreement" id="agreement">我已阅读并同意<a target="_blank" href="https://www.yizanzhu.com/web/index/term_of_service.html">服务条款</a>
                        </label>
                    </div>
                    <br>
                    <button id="redister_button" class="btn btn-primary btn-block" type="button" onclick="submitForm(); return false;" style="background-color: #70c846">确定</button>
                </form>
            </div>
        </div>


        <div id="alert" style="display:none">
            <div class="alert alert-error">
            </div>
        </div>
    </div>
</div>

<div id="jquery_ajax_loading" class="layer-warning modal" style="margin-top:300px;display:none1; overflow-y:auto;">
    <div class="modal-dialog" style="width:450px;">
        <div class="modal-content">
            <div class="modal-body">
                <p><span class="icon-warning"></span> 页面正在加载中，请耐心等待...</p>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript">
    var verifyCode = new GVerify("v_container");
    //注册表单提交
    function submitForm(){
        var res = verifyCode.validate(document.getElementById("validate_code").value);
        if (!res) {
            $("#alert").show();
            $("#alert .alert").text('验证码输入错误！');
            $("#validate_code").focus();
            return false;
        }
        if(!$("#agreement").is(':checked')){
            $("#alert").show();
            $("#alert .alert").text('请阅读并同意《服务条款》！');
            return false;
        }
        if($.trim($("#mobile").val())==''){
            $("#alert").show();
            $("#alert .alert").text('请输入手机号码！');
            $("#mobile").focus();
            return false;
        }
        if(!validateRules.isMobile($('#mobile').val())){
            $("#alert").show();
            $("#alert .alert").text('请正确输入您的手机号！');
            $("#mobile").focus();
            return false;
        }
        if($("#mobile_validate_code").val()==''){
            $("#alert").show();
            $("#alert .alert").text('请输入社团名称！');
            $("#mobile_validate_code").focus();
            return false;
        }
        if(!validateRules.betweenLength($('#password').val(),6,20)){
            $("#alert").show();
            $("#alert .alert").text('请输入6到20位的密码！');
            $("#password").focus();
            return false;
        }
        if($.trim($("#username").val())==''){
            $("#alert").show();
            $("#alert .alert").text('请输入姓名！');
            $("#username").focus();
            return false;
        }
        var e_mailformat = /^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/;
        if (!e_mailformat.test($("#e_mail").val())){
            $("#alert").show();
            $("#alert .alert").text('邮箱格式不符！');
            $("#username").focus();
            return false;
        }


        var returnUrl = 'login.html';
        var id = $.trim($("#mobile").val());
        var contact_name = $.trim($("#username").val());
        var password = $.trim($('#password').val());
        var association_name = $.trim($('#mobile_validate_code').val());
        var e_mail = $.trim($('#e_mail').val());
        $.ajax({
            type:"POST",
            url:"register.php",
            data:{
                id:id,
                contact_name:contact_name,
                password:password,
                association_name:association_name,
                e_mail:e_mail
            },
            async:false,
            beforeSend: function() {
                //验证发送ajax
                $("#redister_button").attr('disabled',true).text('提交中...');
            },
            success:function(objsnd){
                //创建成功
                if (objsnd.result == 0)
                {
                    alert("注册成功！");
					if(returnUrl){
							window.location.href=returnUrl;
						}else{
							location.reload();
 						}
                }else if (objsnd.result == 1){
                    $("#alert").show();
                    $("#alert .alert").text('账号已存在！');
                    $("#redister_button").attr('disabled',false).html('确定');
                    return false;
                }else if (objsnd.result == 2){
                    $("#alert").show();
                    $("#alert .alert").text('注册错误');
                    alert(objsnd);
                    alert(objsnd.errormsg);
                    $("#redister_button").attr('disabled',false).html('确定');
                    return false;
                }else if (objsnd.result == 3){
                    $("#alert").show();
                    $("#alert .alert").text('同一个企业/组织/个人只能注册一个账号！如非本社团操作，请尽快联系本站！');
                    $("#redister_button").attr('disabled',false).html('确定');
                    return false;
                }else{
                    $("#alert").show();
                    $("#alert .alert").text('请求出错，请重试！');
                    $("#redister_button").attr('disabled',false).html('确定');
                    return false;
                }

            },
            complete: function(){
                // 				alert('complete');
            },
            error: function(){
                //请求出错处理
                $("#alert").show();
                $("#alert .alert").text('请求出错，请重试！');
                $("#redister_button").attr('disabled',false).html('确定');
                return false;
            }
        });

        return false;
    }

    //回车键提交表单
    $("#reg_form").keyup(function(e){
        var e = e || event;
        var keycode = e.which || e.keyCode;
        if (keycode==13) {
            $("#redister_button").trigger("click");
        }
    });

</script>


<script type="text/javascript">
    //收藏
    // 			function addFavorite() {
    // 				if (document.all) {
    // 					try {
    // 						window.external.addFavorite(window.location.href, document.title);
    // 					} catch (e) {
    // 						window.alert("对不起，您的浏览器不支持此操作！\n\r请您使用使用Ctrl+D收藏本站");
    // 					}
    // 				} else if (window.sidebar) {
    // 					window.sidebar.addPanel(document.title, window.location.href, "");
    // 				} else {
    // 					window.alert("对不起，您的浏览器不支持此操作！\n\r请您使用使用Ctrl+D收藏本站");
    // 				}
    // 			}

    // 			function forwardEmailLink(email) {
    // 				if (email == null || email == "") return "";
    // 				var emlower = email.toLowerCase();
    // 				var link = "<a target='_blank' href='http://";
    // 				if (emlower.indexOf("@qq.com") > 0 || emlower.indexOf("@163.com") > 0 || emlower.indexOf("@126.com") > 0 || emlower.indexOf("@tom.com") > 0 || emlower.indexOf("@sina.com") > 0 || emlower.indexOf("@yahoo.com") > 0) {
    // 					link += "mail." + emlower.substring(emlower.indexOf("@") + 1);
    // 				}
    // 				else {
    // 					link += "www." + emlower.substring(emlower.indexOf("@") + 1);
    // 				}
    // 				link += "'>前往查收</a>";
    // 				return link;
    // 			}

</script>


</body></html>